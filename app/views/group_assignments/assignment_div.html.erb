<% gps = group_assignments(@assignment.id)%>
<div class="group_assignment_details">
  <div class="group_assignment_content" id="group_assignment_content_<%=@assignment.id%>">

      <% unless gps.nil? or gps.empty? %>
        <% gps.each do |group| %>
          <div class="group_participants" id="group_<%=group['id']%>">
            <h3 class="group_assignment_name" id="group_name_<%=group["id"]%>"><%= group["group_name"] %></h3>
            <div id="edit_group_<%=group["id"]%>" style="display:none;">
              <%= text_field_tag "new_groups_names[][#{@assignment.id}]", group["group_name"], :group_id => group["id"], :id => "text_field_group_#{group['id']}", :class => "rename_group" %>
              <% group_has_files = !SendAssignment.find_all_by_group_assignment_id(group["id"]).empty? %>
              <% data_tooltip = !group_has_files ? nil : t(:group_assignment_delete_error) %>
              <a id="remove_group_<%=group['id']%>" class="remove_group" onclick="delete_group('group_<%=group['id']%>', <%=@assignment.id%>, <%=group_has_files%>);" title="<%=data_tooltip%>">x</a>
            </div>
            <% gp = group_participants(group["id"])%>
            <ul id="group_ul_<%=group['id']%>" value="<%=group['id']%>" name="groups_ul">
              <% unless gp.empty? %>
                <% gp.each do |p| %>
                  <% can_be_moved = SendAssignment.find_all_by_group_assignment_id_and_user_id(group["id"], p["user_id"]).empty? %>
                  <% data_tooltip = can_be_moved ? nil : t(:student_already_sent_files) %>
                  <li class="student_<%=p['user_id']%>" value="<%=p['user_id']%>" id="<%=can_be_moved%>" onmouseover="student_mouseover(this, '<%=t(:student_already_sent_files)%>');" onmouseout="student_mouseout(this);"><%= p["name"] %>
                <% end %>
              <% else %>
                <li id="no_students_message"><%= t(:no_participant_group_assignment) %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
      <% end %>

      <div class="group_participants">
        <h3 class="group_assignment_name"><%= t(:students_with_no_group) %></h3>
        <%= hidden_field_tag "new_groups_names[][#{@assignment.id}]", 'no_group', :class => "rename_group" %>
          <ul id='ul_no_group'>
            <% unless @students_without_group.nil? or @students_without_group.empty? %>
              <% @students_without_group.each do |student_without_group| %>
                <li class="student_<%=student_without_group.id%>" value="<%=student_without_group.id%>" id="true" onmouseover="student_mouseover(this, 'no_message');" onmouseout="student_mouseout(this);"><%= student_without_group.name %></li>
              <% end %>
            <% else %>
              <li id="no_students_message"><%= t(:no_participant_group_assignment) %></li>
            <% end %>
          </ul>
      </div>

    </div>

</div>
