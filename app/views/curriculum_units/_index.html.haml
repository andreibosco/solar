= javascript_include_tag "tooltip", "edition"

.block_wrapper#list_curriculum_units

  .block_title
    %h2
      %i.icon-docs
      = t(:my_solar_curriculum_units)
    %span.right_buttons_form
      = button_tag t(".new"), :class => "btn btn_main btn_form", id: "btn_new_curriculum_unit", :type => :button

  %table.tb_list{:cellpadding => "10", :cellspacing => "0", :width => "100%", :style => "table-layout: fixed"}
    %thead
      %tr.lines
        %th{:width => "12%"}= CurriculumUnit.human_attribute_name(:code) 
        %th{:width => "38%"}= CurriculumUnit.human_attribute_name(:name)
        %th{:width => "28%"}= CurriculumUnit.human_attribute_name(:category)
        %th{:width => "10%"}
        %th{:width => "10%"}
    %tbody
      - @curriculum_units.each do |curriculum_unit|
        %tr.lines
          %td= curriculum_unit.code
          %td= curriculum_unit.name
          %td{:align => "left"}= curriculum_unit.curriculum_unit_type.description
          %td
            = form_for(:curriculum_unit, :url => edit_curriculum_unit_path(curriculum_unit)) do |f|
              = button_tag (content_tag(:i, nil, class: 'icon-edit')), :class => "btn btn_default edit", :type => :button, :alt => t(".edit_curriculum_unit", :curriculum_unit => curriculum_unit.name), :id => t(".edit_curriculum_unit", :curriculum_unit => curriculum_unit.name), disabled: (not can? :update, curriculum_unit), :'data-tooltip' => t(".edit")
          %td
            = link_to (content_tag(:i, nil, :class=>'icon-trash')), "#", class: 'btn btn_caution delete_curriculum_unit', :"data-link-delete" => curriculum_unit_path(curriculum_unit), :'data-tooltip' => t(".delete"), id: "curriculum_unit-del-#{curriculum_unit.id}"

            /= link_to (content_tag(:i, nil, class: 'icon-trash')), "#", class: 'btn btn_caution delete', :'data-tooltip' => t(".delete_curriculum_unit"), :"data-link-delete" => curriculum_unit_path(curriculum_unit)#, disabled: (not(can? :destroy, offer, on: [offer.allocation_tag.id]) or (offer.has_any_lower_association?))

:javascript

  $(function(){
    $('#btn_new_curriculum_unit').click(function(){
      open_lightbox2('#{new_curriculum_unit_path(type: @type) }', '#{t(:curriculum_unit_new_title)}');
    });

    $('.edit').click(function(){
      open_lightbox2($(this).parent().attr('action'), $(this).attr('alt'));
    });

    $('.delete_curriculum_unit').click(function(){
      $(this).nice_delete({parent: 'tr.lines'});
    });
  });
  